
    <!doctype html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
    <html><head><title>RSF: sfavvvdwe2d</title>
    <style type="text/css"><!--
    TT { font-family: lucidatypewriter, lucida console, courier }
    --></style></head><body bgcolor="#f0f0f8">
    
    <table width="100%" cellspacing=0 cellpadding=2 border=0
    summary="heading">
    <tr bgcolor="#7799ee">
    <td valign=bottom>&nbsp;<br>
    <font color="#ffffff" face="helvetica, arial">&nbsp;<br><big><big><strong>sfavvvdwe2d</strong></big></big> (2.1-git)</font></td
    ><td align=right valign=bottom
    ><font color="#ffffff" face="helvetica, arial"><a href="./index.html">index</a><br><a href="https://github.com/ahay/src/blob/madagascar-2.1-git/user/fperrone/Mavvvdwe2d.c">user/fperrone/Mavvvdwe2d.c</a></font></td></tr></table>
    2D acoustic variable-velocity variable-density time-domain FD modeling 
    <p>
    <table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
    <tr bgcolor="#aa55cc">
    <td colspan=3 valign=bottom>&nbsp;<br>
    <font color="#fffff" face="helvetica, arial"><big><strong>Synopsis</strong></big></font></td></tr>
    
        <tr><td bgcolor="#aa55cc"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%">sfavvvdwe2d < Fwav.rsf vel=Fvel.rsf den=Fden.rsf sou=Fsou.rsf rec=Frec.rsf > Fdat.rsf wfl=Fwfl.rsf verb=n snap=n free=n dabc=n adj=n jdata=1 jsnap=nt nqz=sf_n(az) nqx=sf_n(ax) oqz=sf_o(az) oqx=sf_o(ax)</td></tr></table><br>
The code uses a standard second-order stencil in time.<br>
The coefficients of the spatial stencil are computed <br>
by matching the transfer function of the discretized <br>
first-derivative operator to the ideal response. <br>
The optimized coefficients minimize dispersion <br>
given that particular size of the stencil.<br>
<br>
The term <br>
	ro div (1/ro grad (u))<br>
where<br>
	ro   : density<br>
	div  : divergence op<br>
	grad : gradient  op<br>
	u    : wavefield<br>
	<br>
is implemented in order to obtain a positive semi-definite operator.<br>
<br>
The code implements both the forward (adj=n) and adjoint (adj=y) modeling operator.<br>
<br>
============= FILE DESCRIPTIONS   ========================      <br>
<br>
Fdat.rsf - An RSF file containing your data in the following format:<br>
			axis 1 - Receiver location<br>
			axis 2 - Time<br>
			<br>
Fwav.rsf - An RSF file containing your VOLUME DENSITY INJECTION RATE <br>
wavelet information.  The sampling interval, origin time, <br>
and number of time samples will be used as the defaults for the modeling code.<br>
	       i.e. your wavelet needs to have the same length and parameters that you want to model with!<br>
	       The first axis is the number of source locations.<br>
	       The second axis is time.<br>
		   <br>
Fvel.rsf - An N dimensional RSF file that contains the values for the velocity field at every point in the computational domain.<br>
		<br>
Fden.rsf - An N dimensional RSF file that contains the values for density at every point in the computational domain.<br>
<br>
Frec.rsf - Coordinates of the receivers<br>
		axis 1 - (x,z) of the receiver<br>
		axis 2 - receiver index<br>
<br>
Fsou.rsf - Coordinate of the sources<br>
		axis 1 - (x,y,z) of the source<br>
		axis 2 - source index<br>
<br>
Fwfl.rsf - Output wavefield<br>
<br>
verb=y/n - verbose flag<br>
<br>
snap=y/n - wavefield snapshots flag<br>
<br>
free=y/n - free surface on/off<br>
<br>
dabc=y/n - absorbing boundary conditions on/off<br>
<br>
jdata    - data sampling <br>
<br>
jsnap    - wavefield snapshots sampling<br>
<br>
<br>
Author: Francesco Perrone<br>
Date: November 2013<br>

    <p>
    <table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
    <tr bgcolor="#ee77aa">
    <td colspan=3 valign=bottom>&nbsp;<br>
    <font color="#ffffff" face="helvetica, arial"><big><strong>Parameters</strong></big></font></td></tr>
    
        <tr><td bgcolor="#ee77aa"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%">
    <table width="100%" cellspacing=0 cellpadding=2 border=0
    summary="heading">
    <tr bgcolor="#ffc8d8">
    <td valign=bottom>
    <font color="#000000" face="helvetica, arial">&nbsp;<br>bool    <strong>adj=n</strong> [y/n]</font></td
    ><td align=right valign=bottom
    ><font color="#000000" face="helvetica, arial">	Adjoint flag<br>
</font></td></tr></table>
    

    <table width="100%" cellspacing=0 cellpadding=2 border=0
    summary="heading">
    <tr bgcolor="#f0f0f8">
    <td valign=bottom>
    <font color="#000000" face="helvetica, arial">&nbsp;<br>bool    <strong>dabc=n</strong> [y/n]</font></td
    ><td align=right valign=bottom
    ><font color="#000000" face="helvetica, arial">	Absorbing BC <br>
</font></td></tr></table>
    

    <table width="100%" cellspacing=0 cellpadding=2 border=0
    summary="heading">
    <tr bgcolor="#ffc8d8">
    <td valign=bottom>
    <font color="#000000" face="helvetica, arial">&nbsp;<br>file    <strong>den=</strong> </font></td
    ><td align=right valign=bottom
    ><font color="#000000" face="helvetica, arial">	auxiliary input file name<br>
</font></td></tr></table>
    

    <table width="100%" cellspacing=0 cellpadding=2 border=0
    summary="heading">
    <tr bgcolor="#f0f0f8">
    <td valign=bottom>
    <font color="#000000" face="helvetica, arial">&nbsp;<br>bool    <strong>free=n</strong> [y/n]</font></td
    ><td align=right valign=bottom
    ><font color="#000000" face="helvetica, arial">	Free surface flag <br>
</font></td></tr></table>
    

    <table width="100%" cellspacing=0 cellpadding=2 border=0
    summary="heading">
    <tr bgcolor="#ffc8d8">
    <td valign=bottom>
    <font color="#000000" face="helvetica, arial">&nbsp;<br>int     <strong>jdata=1</strong> </font></td
    ><td align=right valign=bottom
    ><font color="#000000" face="helvetica, arial">	# of t steps at which to save receiver data <br>
</font></td></tr></table>
    

    <table width="100%" cellspacing=0 cellpadding=2 border=0
    summary="heading">
    <tr bgcolor="#f0f0f8">
    <td valign=bottom>
    <font color="#000000" face="helvetica, arial">&nbsp;<br>int     <strong>jsnap=nt</strong> </font></td
    ><td align=right valign=bottom
    ><font color="#000000" face="helvetica, arial">	# of t steps at which to save wavefield <br>
</font></td></tr></table>
    

    <table width="100%" cellspacing=0 cellpadding=2 border=0
    summary="heading">
    <tr bgcolor="#ffc8d8">
    <td valign=bottom>
    <font color="#000000" face="helvetica, arial">&nbsp;<br>int     <strong>nqx=sf_n(ax)</strong> </font></td
    ><td align=right valign=bottom
    ><font color="#000000" face="helvetica, arial">	Saved wfld window nx <br>
</font></td></tr></table>
    

    <table width="100%" cellspacing=0 cellpadding=2 border=0
    summary="heading">
    <tr bgcolor="#f0f0f8">
    <td valign=bottom>
    <font color="#000000" face="helvetica, arial">&nbsp;<br>int     <strong>nqz=sf_n(az)</strong> </font></td
    ><td align=right valign=bottom
    ><font color="#000000" face="helvetica, arial">	Saved wfld window nz <br>
</font></td></tr></table>
    

    <table width="100%" cellspacing=0 cellpadding=2 border=0
    summary="heading">
    <tr bgcolor="#ffc8d8">
    <td valign=bottom>
    <font color="#000000" face="helvetica, arial">&nbsp;<br>float   <strong>oqx=sf_o(ax)</strong> </font></td
    ><td align=right valign=bottom
    ><font color="#000000" face="helvetica, arial">	Saved wfld window ox <br>
</font></td></tr></table>
    

    <table width="100%" cellspacing=0 cellpadding=2 border=0
    summary="heading">
    <tr bgcolor="#f0f0f8">
    <td valign=bottom>
    <font color="#000000" face="helvetica, arial">&nbsp;<br>float   <strong>oqz=sf_o(az)</strong> </font></td
    ><td align=right valign=bottom
    ><font color="#000000" face="helvetica, arial">	Saved wfld window oz <br>
</font></td></tr></table>
    

    <table width="100%" cellspacing=0 cellpadding=2 border=0
    summary="heading">
    <tr bgcolor="#ffc8d8">
    <td valign=bottom>
    <font color="#000000" face="helvetica, arial">&nbsp;<br>file    <strong>rec=</strong> </font></td
    ><td align=right valign=bottom
    ><font color="#000000" face="helvetica, arial">	auxiliary input file name<br>
</font></td></tr></table>
    

    <table width="100%" cellspacing=0 cellpadding=2 border=0
    summary="heading">
    <tr bgcolor="#f0f0f8">
    <td valign=bottom>
    <font color="#000000" face="helvetica, arial">&nbsp;<br>bool    <strong>snap=n</strong> [y/n]</font></td
    ><td align=right valign=bottom
    ><font color="#000000" face="helvetica, arial">	Wavefield snapshots flag <br>
</font></td></tr></table>
    

    <table width="100%" cellspacing=0 cellpadding=2 border=0
    summary="heading">
    <tr bgcolor="#ffc8d8">
    <td valign=bottom>
    <font color="#000000" face="helvetica, arial">&nbsp;<br>file    <strong>sou=</strong> </font></td
    ><td align=right valign=bottom
    ><font color="#000000" face="helvetica, arial">	auxiliary input file name<br>
</font></td></tr></table>
    

    <table width="100%" cellspacing=0 cellpadding=2 border=0
    summary="heading">
    <tr bgcolor="#f0f0f8">
    <td valign=bottom>
    <font color="#000000" face="helvetica, arial">&nbsp;<br>file    <strong>vel=</strong> </font></td
    ><td align=right valign=bottom
    ><font color="#000000" face="helvetica, arial">	auxiliary input file name<br>
</font></td></tr></table>
    

    <table width="100%" cellspacing=0 cellpadding=2 border=0
    summary="heading">
    <tr bgcolor="#ffc8d8">
    <td valign=bottom>
    <font color="#000000" face="helvetica, arial">&nbsp;<br>bool    <strong>verb=n</strong> [y/n]</font></td
    ><td align=right valign=bottom
    ><font color="#000000" face="helvetica, arial">	Verbosity flag <br>
</font></td></tr></table>
    

    <table width="100%" cellspacing=0 cellpadding=2 border=0
    summary="heading">
    <tr bgcolor="#f0f0f8">
    <td valign=bottom>
    <font color="#000000" face="helvetica, arial">&nbsp;<br>file    <strong>wfl=</strong> </font></td
    ><td align=right valign=bottom
    ><font color="#000000" face="helvetica, arial">	auxiliary output file name<br>
</font></td></tr></table>
    
</td></tr></table>
    </body></html>